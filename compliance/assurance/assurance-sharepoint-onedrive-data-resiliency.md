---
title: Microsoft 365 での SharePoint と OneDrive のデータ復元
description: この記事では、Microsoft 365 の SharePoint と OneDrive のデータ復元の概要について説明します。
ms.author: robmazz
author: robmazz
manager: laurawi
ms.reviewer: sosstah
audience: ITPro
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- MET150
f1.keywords:
- NOCSH
ms.collection:
- Strat_O365_IP
- M365-security-compliance
- MS-Compliance
titleSuffix: Microsoft Service Assurance
ms.openlocfilehash: c940b778681805a1e50a9e565117cd67deb52566
ms.sourcegitcommit: 2973d25e9e0185b84d281f963553a332eac1c1a3
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/28/2021
ms.locfileid: "50040383"
---
# <a name="sharepoint-and-onedrive-data-resiliency-in-microsoft-365"></a><span data-ttu-id="b7a9a-103">Microsoft 365 での SharePoint と OneDrive のデータ復元</span><span class="sxs-lookup"><span data-stu-id="b7a9a-103">SharePoint and OneDrive data resiliency in Microsoft 365</span></span>

<span data-ttu-id="b7a9a-104">Microsoft 365 では、OneDrive は SharePoint ファイル プラットフォーム上に構築されています。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-104">Within Microsoft 365, OneDrive is built on top of the SharePoint file platform.</span></span> <span data-ttu-id="b7a9a-105">この記事では、SharePoint のみを使用して両方の製品を参照します。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-105">In this article, only SharePoint will be used to refer to both products.</span></span> <span data-ttu-id="b7a9a-106">この記事の内容は Microsoft 365 に関連し、コンシューマー サービスには適用されません。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-106">The contents of this article are relevant to Microsoft 365 and do not apply to consumer services.</span></span>

<span data-ttu-id="b7a9a-107">SharePoint のコア コンテンツ ストレージを構成する主なアセットは 2 種類です。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-107">There are two primary assets that make up the core content storage of SharePoint:</span></span>

- <span data-ttu-id="b7a9a-108">**メタデータ**: 各ファイルに関するメタデータは、Azure SQL Database に格納されます。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-108">**Metadata**: Metadata about each file is stored in Azure SQL Database.</span></span> <span data-ttu-id="b7a9a-109">Azure SQLは、SharePoint が使用する完全なビジネス継続性のストーリーを提供します。詳細については、この記事の後半で説明します。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-109">Azure SQL offers a complete business continuity story that SharePoint uses and details are covered later in this article.</span></span>
- <span data-ttu-id="b7a9a-110">**BLOB ストレージ**: SharePoint にアップロードされるユーザー コンテンツは、Azure Storage に格納されます。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-110">**Blob storage**: User content that is uploaded into SharePoint is stored in Azure Storage.</span></span> <span data-ttu-id="b7a9a-111">SharePoint は、ユーザー コンテンツのほぼリアルタイムの重複と、本当にアクティブ/アクティブなシステムを保証するために、Azure Storage の上にカスタムの復元計画を構築しました。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-111">SharePoint has built a custom resiliency plan on top of Azure Storage to ensure near real-time duplication of user content and a truly active/active system.</span></span>

<span data-ttu-id="b7a9a-112">データの回復性を確保するためのコントロールの完全なセットについては、詳細なセクションで説明します。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-112">The complete set of controls to ensure data resiliency is explained in further sections.</span></span>

## <a name="blob-storage-resilience"></a><span data-ttu-id="b7a9a-113">BLOB ストレージの復元</span><span class="sxs-lookup"><span data-stu-id="b7a9a-113">Blob storage resilience</span></span>

<span data-ttu-id="b7a9a-114">SharePoint には、Azure Storage に顧客データを保存するカスタムビルド ソリューションがあります。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-114">SharePoint has a custom-built solution for storage of customer data in Azure Storage.</span></span> <span data-ttu-id="b7a9a-115">すべてのファイルは、プライマリ データセンター リージョンとセカンダリ データセンター リージョンの両方に同時に書き込まれます。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-115">Every file is simultaneously written into both a primary and a secondary datacenter region.</span></span> <span data-ttu-id="b7a9a-116">いずれかの Azure 地域への書き込みを失敗すると、ファイルの保存は失敗します。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-116">If writes to either Azure region fail, the file save will fail.</span></span> <span data-ttu-id="b7a9a-117">コンテンツが Azure Storage に書き込まれると、チェックサムはメタデータと別個に格納され、コミットされた書き込みを、今後のすべての読み取り中に SharePoint に送信される元のファイルと同じにするために使用されます。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-117">After the contents are written into Azure Storage, checksums are stored separately with metadata, and are used to ensure that the committed write is identical to the original file sent to SharePoint during all future reads.</span></span> <span data-ttu-id="b7a9a-118">この同じ手法をすべてのワークフローで使用して、発生する破損の伝達を防止します。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-118">This same technique is used in all workflows to prevent propagation of any corruption that should occur.</span></span> <span data-ttu-id="b7a9a-119">各地域内で、Azure Locally Redundant Storage (LRS) は高レベルの信頼性を提供します。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-119">Within each region, Azure Locally Redundant Storage (LRS) provides a high level of reliability.</span></span> <span data-ttu-id="b7a9a-120">詳細については [、Azure Storage の冗長性に関する](https://docs.microsoft.com/azure/storage/common/storage-redundancy-lrs) 記事を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-120">See the [Azure Storage redundancy](https://docs.microsoft.com/azure/storage/common/storage-redundancy-lrs) article for details.</span></span>

<span data-ttu-id="b7a9a-121">SharePoint はストレージAppend-Only使用します。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-121">SharePoint uses Append-Only storage.</span></span> <span data-ttu-id="b7a9a-122">このプロセスにより、最初の保存後にファイルを変更したり破損したりすることはできませんが、製品内のバージョン管理を使用すると、以前のバージョンのファイル コンテンツを取得できます。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-122">This process ensures that files cannot be changed or corrupted after an initial save, but also by using in-product versioning, any previous version of the file contents can be retrieved.</span></span>

<span data-ttu-id="b7a9a-123">どちらのデータセンターの SharePoint 環境でも、両方の Azure リージョンのストレージ コンテナーにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-123">SharePoint environments in either datacenter can access storage containers in both Azure regions.</span></span> <span data-ttu-id="b7a9a-124">パフォーマンス上の理由から、同じローカル データセンター内のストレージ コンテナーが常に優先されます。ただし、目的のしきい値内に結果が表示されない読み取り要求には、データが常に使用可能なことを確認するためにリモート データセンターから要求されたコンテンツが同じになります。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-124">For performance reasons the storage container in the same local datacenter is always preferred, however, read requests that do not see results within a desired threshold will have the same content requested from the remote datacenter to ensure data is always available.</span></span>

## <a name="metadata-resilience"></a><span data-ttu-id="b7a9a-125">メタデータの復元</span><span class="sxs-lookup"><span data-stu-id="b7a9a-125">Metadata resilience</span></span>

<span data-ttu-id="b7a9a-126">SharePoint メタデータは、Azure Storage に格納されているコンテンツの場所とアクセス キーを格納するユーザー コンテンツへのアクセスにも重要です。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-126">SharePoint metadata is also critical to accessing user content as it stores the location of and access keys to the content stored in Azure Storage.</span></span> <span data-ttu-id="b7a9a-127">これらのデータベースは、広範なビジネス継続性SQLを持つ Azure SQL [に格納されます](https://docs.microsoft.com/azure/sql-database/sql-database-business-continuity)。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-127">These databases are stored in Azure SQL, which has an extensive [business continuity plan](https://docs.microsoft.com/azure/sql-database/sql-database-business-continuity).</span></span>

<span data-ttu-id="b7a9a-128">SharePoint は Azure SQL が提供するレプリケーション モデルを使用し、専用の自動化テクノロジを構築してフェールオーバーが必要かどうかを判断し、必要に応じて操作を開始します。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-128">SharePoint uses the replication model provided by Azure SQL and has built a proprietary automation technology to determine a failover is required and to initiate the operation if necessary.</span></span> <span data-ttu-id="b7a9a-129">そのため、Azure の観点から見ると、"手動データベース フェールオーバー" カテゴリSQLされます。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-129">As such, it falls into the 'Manual database failover' category from an Azure SQL perspective.</span></span> <span data-ttu-id="b7a9a-130">データベースの回復性に関する Azure SQLの指標は、こちらから参照 [できます](https://docs.microsoft.com/azure/azure-sql/database/business-continuity-high-availability-disaster-recover-hadr-overview#recover-a-database-to-the-existing-server)。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-130">The latest metrics for Azure SQL database recoverability are available [here](https://docs.microsoft.com/azure/azure-sql/database/business-continuity-high-availability-disaster-recover-hadr-overview#recover-a-database-to-the-existing-server).</span></span>

<span data-ttu-id="b7a9a-131">SharePoint は Azure SQLのバックアップ システムを使用して、Point in Time Restores (PITR) を最大 14 日間有効にしています。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-131">SharePoint uses Azure SQL's backup system to enable Point in Time Restores (PITR) for up to 14 days.</span></span> <span data-ttu-id="b7a9a-132">PITR については、後のセクションで [詳しい説明を参照してください。](#deletion-backup-and-point-in-time-restore)</span><span class="sxs-lookup"><span data-stu-id="b7a9a-132">PITR is covered more in a [later section.](#deletion-backup-and-point-in-time-restore)</span></span>

## <a name="automated-failover"></a><span data-ttu-id="b7a9a-133">自動フェールオーバー</span><span class="sxs-lookup"><span data-stu-id="b7a9a-133">Automated failover</span></span>

<span data-ttu-id="b7a9a-134">SharePoint は、場所固有のイベントが発生した場合のカスタマー エクスペリエンスへの影響を最小限に抑えるために、カスタムビルドの自動フェールオーバーを使用します。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-134">SharePoint uses a custom-built automated failover to minimize the impact on customer experience when a location-specific event occurs.</span></span> <span data-ttu-id="b7a9a-135">特定のしきい値を超える単一または複数コンポーネントの障害を監視型の自動化が検出すると、すべてのユーザーのアクティビティが問題のある環境からウォーム セカンダリに自動的にリダイレクトされます。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-135">Monitoring-driven automation detecting a single or multi-component failure beyond certain thresholds will result in automated redirection of all users' activity out of the problematic environment and over to a warm secondary.</span></span> <span data-ttu-id="b7a9a-136">フェールオーバーによって、メタデータとコンピューティング ストレージが新しいデータセンターから完全に提供されます。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-136">A failover results in metadata and compute storage being served entirely out of the new datacenter.</span></span> <span data-ttu-id="b7a9a-137">BLOB ストレージは常に完全にアクティブ/アクティブで実行されるので、フェールオーバーに変更を行う必要はありません。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-137">As blob storage always runs entirely active/active, no change is required for a failover.</span></span> <span data-ttu-id="b7a9a-138">コンピューティング層は最も近い BLOB コンテナーを優先しますが、いつでもローカルとリモートの両方の BLOB ストレージの場所を使用して可用性を確保します。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-138">The compute tier will prefer the nearest blob container but will use both local and remote blob storage locations at any time to ensure availability.</span></span>

<span data-ttu-id="b7a9a-139">SharePoint は、Azure フロント ドア サービスを使用して、Microsoft ネットワーク内部へのルーティングを提供します。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-139">SharePoint uses the Azure Front Door service to provide routing internal to the Microsoft network.</span></span> <span data-ttu-id="b7a9a-140">この構成により、DNS に依存しないフェールオーバー リダイレクトが可能で、ローカル コンピューターのキャッシュの影響が軽減されます。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-140">This configuration allows failover redirection independent of DNS and reduces the effect of local-machine caching.</span></span> <span data-ttu-id="b7a9a-141">ほとんどのフェールオーバー操作はエンド ユーザーに対して透過的です。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-141">Most failover operations are transparent to end users.</span></span> <span data-ttu-id="b7a9a-142">フェールオーバーがある場合、お客様はサービスへのアクセスを維持するために変更を加える必要がなされません。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-142">If there is a failover, customers will not need to make any changes in order to maintain access to the service.</span></span>

## <a name="versioning-and-files-restore"></a><span data-ttu-id="b7a9a-143">バージョン管理とファイルの復元</span><span class="sxs-lookup"><span data-stu-id="b7a9a-143">Versioning and Files Restore</span></span>

<span data-ttu-id="b7a9a-144">新しく作成されたドキュメント ライブラリの場合、SharePoint は、すべてのファイルで既定で 500 バージョンに設定され、必要に応じてより多くのバージョンを保持するように構成できます。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-144">For newly created document libraries, SharePoint defaults to 500 versions on every file and can be configured to retain more versions if desired.</span></span> <span data-ttu-id="b7a9a-145">UI では、設定できるバージョンが 100 未満の値は許可されませんが、パブリック API を使用して、より少ないバージョンを格納するシステムを設定できます。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-145">The UI doesn't allow a value fewer than 100 versions to be set, but it is possible to set the system to store fewer versions using public APIs.</span></span> <span data-ttu-id="b7a9a-146">信頼性を高め、100 未満の値を指定すると、ユーザー アクティビティが不注意でデータを失う可能性があります。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-146">For reliability, any value less than 100 isn't recommended and can result in user activity causing inadvertent data loss.</span></span>

<span data-ttu-id="b7a9a-147">バージョン管理の詳細については [、「SharePoint でのバージョン管理」を参照してください](https://docs.microsoft.com/microsoft-365/community/versioning-basics-best-practices)。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-147">For more information about versioning, see [Versioning in SharePoint](https://docs.microsoft.com/microsoft-365/community/versioning-basics-best-practices).</span></span>

<span data-ttu-id="b7a9a-148">ファイルの復元は、SharePoint のドキュメント ライブラリで過去 30 日間の任意の秒に "時間に戻る" 機能です。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-148">Files Restore is the ability to go 'back in time' on any Document Library in SharePoint to any second of time in the last 30 days.</span></span> <span data-ttu-id="b7a9a-149">このプロセスは、ランサムウェア、大量削除、破損、その他のイベントから回復するために使用できます。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-149">This process can be used to recover from ransomware, mass deletions, corruption, or any other event.</span></span> <span data-ttu-id="b7a9a-150">この機能ではファイル バージョンが使用されます。したがって、既定のバージョンを減らすと、この復元の効果が低下します。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-150">This feature uses file versions so reducing default versions can reduce the effectiveness of this restore.</span></span>

<span data-ttu-id="b7a9a-151">OneDrive と SharePoint の両方について、ファイル [の復元](https://support.office.com/article/restore-your-onedrive-fa231298-759d-41cf-bcd0-25ac53eb8a15) 機能 [について説明します](https://support.office.com/article/Restore-a-document-library-317791c3-8bd0-4dfd-8254-3ca90883d39a)。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-151">The Files Restore feature is documented for both [OneDrive](https://support.office.com/article/restore-your-onedrive-fa231298-759d-41cf-bcd0-25ac53eb8a15) and [SharePoint](https://support.office.com/article/Restore-a-document-library-317791c3-8bd0-4dfd-8254-3ca90883d39a).</span></span>

## <a name="deletion-backup-and-point-in-time-restore"></a><span data-ttu-id="b7a9a-152">削除、バックアップ、およびポイント イン タイムの復元</span><span class="sxs-lookup"><span data-stu-id="b7a9a-152">Deletion, backup, and Point in Time Restore</span></span>

<span data-ttu-id="b7a9a-153">SharePoint から削除されたユーザー コンテンツは、次の削除フローを通過します。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-153">User content deleted from SharePoint goes through the following deletion flow.</span></span>

<span data-ttu-id="b7a9a-154">削除されたアイテムは、一定の期間、ごみ箱に保持されます。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-154">Deleted items are retained in recycle bins for a certain period of time.</span></span> <span data-ttu-id="b7a9a-155">SharePoint の場合、保持期間は 93 日です。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-155">For SharePoint, the retention time is 93 days.</span></span> <span data-ttu-id="b7a9a-156">元の場所からアイテムを削除すると開始されます。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-156">It begins when you delete the item from its original location.</span></span> <span data-ttu-id="b7a9a-157">サイトのごみ箱からアイテムを削除すると、サイト コレクションのごみ [箱に移動します](https://support.office.com/article/restore-deleted-items-from-the-site-collection-recycle-bin-5fa924ee-16d7-487b-9a0a-021b9062d14b)。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-157">When you delete the item from the site recycle bin, it goes into the [site collection recycle bin](https://support.office.com/article/restore-deleted-items-from-the-site-collection-recycle-bin-5fa924ee-16d7-487b-9a0a-021b9062d14b).</span></span> <span data-ttu-id="b7a9a-158">残りの 93 日間はそこに残り、完全に削除されます。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-158">It stays there for the remainder of the 93 days, and then is permanently deleted.</span></span> <span data-ttu-id="b7a9a-159">ごみ箱の使い方の詳細については、次のリンクを参照してください。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-159">More information about how to use the recycle bin is available at these links:</span></span>

- [<span data-ttu-id="b7a9a-160">ごみ箱内のアイテムを復元する</span><span class="sxs-lookup"><span data-stu-id="b7a9a-160">Restore items in the Recycle Bin</span></span>](https://support.office.com/article/Restore-items-in-the-Recycle-Bin-of-a-SharePoint-site-6df466b6-55f2-4898-8d6e-c0dff851a0be)
- <span data-ttu-id="b7a9a-161">[サイト コレクションのごみ箱から削除済みアイテムを復元します](https://support.office.com/article/Restore-deleted-items-from-the-site-collection-recycle-bin-5fa924ee-16d7-487b-9a0a-021b9062d14b)。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-161">[Restore deleted items from the Site Collection Recycle Bin](https://support.office.com/article/Restore-deleted-items-from-the-site-collection-recycle-bin-5fa924ee-16d7-487b-9a0a-021b9062d14b).</span></span>

<span data-ttu-id="b7a9a-162">このプロセスは既定の削除フローであり、保持ポリシーやラベルは考慮されません。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-162">This process is the default deletion flow and does not take into account retention policies or labels.</span></span> <span data-ttu-id="b7a9a-163">詳細については [、「SharePoint と OneDrive の保持について」を参照してください](https://docs.microsoft.com/microsoft-365/compliance/retention-policies-sharepoint)。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-163">For more information, see [Learn about retention for SharePoint and OneDrive](https://docs.microsoft.com/microsoft-365/compliance/retention-policies-sharepoint).</span></span>

<span data-ttu-id="b7a9a-164">93 日間のリサイクル パイプラインが完了すると、メタデータと Blob ストレージに対して個別に削除が実行されます。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-164">After the 93-day recycle pipeline is complete, deletion takes place independently for Metadata and for Blob Storage.</span></span> <span data-ttu-id="b7a9a-165">メタデータはデータベースから直ちに削除され、メタデータがバックアップから復元されていない限り、コンテンツは読み取り不能になります。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-165">Metadata will be removed immediately from the database, which makes the content unreadable unless the metadata is restored from backup.</span></span> <span data-ttu-id="b7a9a-166">SharePoint は、メタデータの 14 日間分のバックアップを維持します。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-166">SharePoint maintains 14 days-worth of backups of metadata.</span></span> <span data-ttu-id="b7a9a-167">これらのバックアップは、ほぼリアルタイムでローカルに作成され、この文書の時点で 5 分から[](https://docs.microsoft.com/azure/sql-database/sql-database-automated-backups)10 分のスケジュールで、冗長な Azure Storage コンテナー内のストレージにプッシュされます。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-167">These backups are taken locally in near real time and then pushed to storage in redundant Azure Storage containers on, [according to documentation](https://docs.microsoft.com/azure/sql-database/sql-database-automated-backups) at the time of this publication, a 5-10-minute schedule.</span></span>

<span data-ttu-id="b7a9a-168">Blob Storage コンテンツを削除する場合、SharePoint は Azure Blob Storage の回復可能な削除機能を利用して、偶発的または悪意のある削除から保護します。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-168">When deleting Blob Storage content, SharePoint utilizes the soft delete feature for Azure Blob Storage to protect against accidental or malicious deletion.</span></span> <span data-ttu-id="b7a9a-169">この機能を使用すると、コンテンツが完全に削除される前に、合計 14 日間コンテンツを復元できます。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-169">Using this feature, we have a total of 14 days in which to restore content before it is permanently deleted.</span></span>

>[!Note]
><span data-ttu-id="b7a9a-170">Microsoft アプリケーションは標準プロセスのごみ箱にコンテンツを送信しますが、SharePoint はごみ箱をスキップして直ちに削除を実行できる API を提供します。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-170">While Microsoft applications will send content to the recycle bin for the standard process, SharePoint does provide APIs that allow for skipping the recycle bin and forcing an immediate delete.</span></span> <span data-ttu-id="b7a9a-171">アプリケーションを確認して、コンプライアンス上の理由で必要な場合にのみこれが行われるか確認します。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-171">Review your applications to ensure this is only done when necessary for compliance reasons.</span></span>

## <a name="integrity-checks"></a><span data-ttu-id="b7a9a-172">整合性チェック</span><span class="sxs-lookup"><span data-stu-id="b7a9a-172">Integrity Checks</span></span>

<span data-ttu-id="b7a9a-173">SharePoint はさまざまな方法を使用して、データ ライフサイクルのすべての段階で BLOB とメタデータの整合性を確保します。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-173">SharePoint uses various methods to ensure the integrity of blobs and metadata at all stages of the data lifecycle:</span></span>

- <span data-ttu-id="b7a9a-174">**メタデータに格納された** ファイル ハッシュ : ファイル全体のハッシュがファイル メタデータと一緒に格納され、すべての操作中にドキュメント レベルのデータ整合性が維持されます。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-174">**File hash stored in metadata**: Hash of the entire file is stored with file metadata to ensure document level data integrity is maintained during all operations</span></span>
- <span data-ttu-id="b7a9a-175">**メタデータに格納された BLOB** ハッシュ : 各 BLOB アイテムは、暗号化されたコンテンツのハッシュを格納して、基になる Azure ストレージの破損から保護します。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-175">**Blob hash stored in metadata**: Each blob-item stores a hash of the encrypted content to protect against corruption in underlying Azure storage.</span></span>
- <span data-ttu-id="b7a9a-176">**データ整合性ジョブ**: 14 日ごとに、データベース内のアイテムを一覧表示し、それらのアイテムを Azure Storage のリストされた BLOB と照合することで、各サイトの整合性がスキャンされます。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-176">**Data integrity job**: Every 14 days, each site is scanned for integrity by listing items in the database and matching those up with listed blobs in Azure storage.</span></span> <span data-ttu-id="b7a9a-177">このジョブは、不足しているストレージ BLOB を BLOB 参照として報告し、必要に応じて [Azure](https://docs.microsoft.com/azure/storage/blobs/soft-delete-blob-overview) ストレージの回復可能な削除機能を使用してそれらの BLOB を取得できます。</span><span class="sxs-lookup"><span data-stu-id="b7a9a-177">The job reports any blob-references missing storage-blobs and can retrieve those blobs through the [Azure storage soft-delete](https://docs.microsoft.com/azure/storage/blobs/soft-delete-blob-overview) feature if needed.</span></span>
